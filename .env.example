# ===========================================
# SUPABASE CONFIGURATION (REQUIRED FOR SSS)
# ===========================================
# Get these from your Supabase project dashboard
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
SUPABASE_ANON_KEY=your_supabase_anon_key_here
VITE_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
VITE_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key_here

# Alternative naming (for compatibility)
SUPABASE_SERVICE_KEY=your_service_role_key_here

# Database Configuration (Legacy)
DATABASE_URL=postgres://username:password@localhost:5432/identity_forge

# Redis Configuration
REDIS_URL=redis://localhost:6379

# JWT Authentication
JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRES_IN=7d

# Nostr Configuration
NOSTR_RELAY_URL=wss://relay.example.com
NOSTR_PRIVATE_KEY=your_nostr_private_key_here

# Lightning Network Configuration
LIGHTNING_NODE_URL=https://your-lightning-node.com
LIGHTNING_MACAROON=your_macaroon_here
LIGHTNING_CERT_PATH=/path/to/tls.cert

# LNbits/Voltage Configuration
VITE_VOLTAGE_LNBITS_URL=https://your-lnbits-instance.com
VITE_VOLTAGE_LNBITS_ADMIN_KEY=your_admin_key_here
VOLTAGE_LNBITS_URL=https://your-lnbits-instance.com
VOLTAGE_LNBITS_ADMIN_KEY=your_admin_key_here

# LNProxy Privacy Configuration
VITE_LNPROXY_URL=https://lnproxy.org
LNPROXY_URL=https://lnproxy.org

# Lightning Address Configuration
VITE_LIGHTNING_ADDRESS_DOMAIN=satnam.pub
LIGHTNING_ADDRESS_DOMAIN=satnam.pub

# NIP-05 Configuration
NIP05_DOMAIN=yourdomain.com

# Family Member Configuration
# Domain used to identify family members for internal transfers
FAMILY_DOMAIN=satnam.pub
# Maximum length for usernames to be considered internal family members
FAMILY_USERNAME_MAX_LENGTH=20

# Server Configuration
PORT=3000
NODE_ENV=development

# ===========================================
# SSS & PRIVACY CONFIGURATION (CRITICAL)
# ===========================================
# Master key for encryption (change in production!)
# Generate with: openssl rand -base64 32
PRIVACY_MASTER_KEY=your-strong-master-key-here-32-chars-minimum

# Privacy-first authentication base salt
VITE_PRIVACY_BASE_SALT=satnam-privacy-2024

# Family encryption key (for browser use)
VITE_FAMILY_ENCRYPTION_KEY=your-family-encryption-key-here

# API Base URL (for browser use)
VITE_API_URL=/api

# Feature flags for SSS system
ENABLE_SSS=true
ENABLE_PRIVACY_MODE=true
ENABLE_FEDERATED_SIGNING=true
ENABLE_GUARDIAN_NOTIFICATIONS=true

# Development flags
DEBUG_LOGGING=false
SQL_LOGGING=false
PRIVACY_AUDIT=true

# ===========================================
# PHOENIXD LSP CONFIGURATION
# ===========================================
# PhoenixD daemon connection settings (for browser use)
VITE_PHOENIXD_HOST=http://127.0.0.1:9740
VITE_PHOENIXD_API_TOKEN=your_phoenixd_api_token_here
VITE_PHOENIXD_USERNAME=phoenix

# Legacy server-side config (if needed)
PHOENIXD_HOST=http://127.0.0.1:9740
PHOENIXD_API_TOKEN=your_phoenixd_api_token_here
PHOENIXD_USERNAME=phoenix
# Family banking configuration (for browser use)
VITE_FAMILY_PHOENIXD_ENABLED=true
VITE_PHOENIXD_MIN_CHANNEL_SIZE=50000

# Family liquidity management (for browser use)
VITE_FAMILY_EMERGENCY_THRESHOLD=10000
VITE_FAMILY_MAX_EMERGENCY=100000
VITE_FAMILY_ALLOWANCE_PREP_DAYS=2

# Legacy server-side config (if needed)
FAMILY_PHOENIXD_ENABLED=true
PHOENIXD_MIN_CHANNEL_SIZE=50000
FAMILY_EMERGENCY_THRESHOLD=10000
FAMILY_MAX_EMERGENCY=100000
FAMILY_ALLOWANCE_PREP_DAYS=2

# Channel size defaults by role (in satoshis)
PHOENIXD_PARENT_CHANNEL_SIZE=200000
PHOENIXD_TEEN_CHANNEL_SIZE=100000
PHOENIXD_CHILD_CHANNEL_SIZE=50000

# ===========================================
# FEDIMINT CONFIGURATION (FOR BROWSER USE)
# ===========================================
VITE_FEDIMINT_FEDERATION_ID=test_federation
VITE_FEDIMINT_GATEWAY_URL=http://127.0.0.1:8080
VITE_FEDIMINT_API_TOKEN=your_fedimint_api_token_here
VITE_FEDIMINT_NETWORK=testnet



# Lightning Tools and NWC feature flags
VITE_USE_ALBY_LIGHTNING_TOOLS=false
VITE_ENABLE_NWC_PROVIDER=true


# ===========================================
# HYBRID MINIMAL-CUSTODY LIGHTNING (LNbits)
# ===========================================
# Base URL of your LNbits instance (no trailing slash)
LNBITS_BASE_URL=

# Instance admin/bootstrapping key (server-only, used for wallet provisioning)
LNBITS_ADMIN_KEY=
# or
LNBITS_BOOTSTRAP_ADMIN_KEY=

# Webhook secret used to validate LNbits payment webhooks
LNBITS_WEBHOOK_SECRET=

# Default Scrub percent when enabling (0..100). 100 = forward all funds by default
LNBITS_DEFAULT_SCRUB_PERCENT=100

# Platform Lightning Address domain used in platform_ln_address
# Platform Lightning Address domain used by both client and Netlify Functions
# Rebranding tip: change this to your new domain and redeploy; no code changes required
# Examples: my.satnam.pub, payments.example.com
VITE_PLATFORM_LIGHTNING_DOMAIN=my.satnam.pub

# Public origin used for CORS security headers
PRODUCTION_ORIGIN=https://www.satnam.pub

# Feature flag gate for LNbits integration (client + server)
VITE_LNBITS_INTEGRATION_ENABLED=false

# Deterministic DUID server secret (server-only)
DUID_SERVER_SECRET=

# Optional: LNURL well-known caching control (seconds). Leave empty for default/no-store.
LNURL_WELL_KNOWN_CACHE_SECONDS=0

# ===========================================
# NIP-85 TRUST PROVIDER CONFIGURATION
# ===========================================
# Phase 1: NIP-85 Trust Provider - Master toggle for all NIP-85 functionality
# When disabled, all NIP-85 features are unavailable
# Default: false (opt-in)
VITE_NIP85_TRUST_PROVIDER_ENABLED=false

# Phase 1: NIP-85 Publishing - Enable publishing trust assertions to Nostr network
# Requires VITE_NIP85_TRUST_PROVIDER_ENABLED=true
# Default: false (opt-in)
VITE_NIP85_PUBLISHING_ENABLED=false

# Phase 1: NIP-85 Query - Enable querying trust assertions from relays
# Allows users to view trust scores published by other providers
# Default: true (enabled by default for read-only access)
VITE_NIP85_QUERY_ENABLED=true

# Phase 1: NIP-85 Caching - Enable in-memory caching for assertion queries
# Improves performance by caching relay queries with TTL
# Default: true (enabled for performance)
VITE_NIP85_CACHE_ENABLED=true

# Phase 1: NIP-85 Audit Logging - Enable audit logging for all query operations
# Logs all trust score queries to trust_query_audit_log table for compliance
# Default: true (enabled for security/compliance)
VITE_NIP85_AUDIT_LOGGING_ENABLED=true

# Phase 1: NIP-85 Cache TTL - Cache time-to-live in milliseconds
# How long to keep cached assertions before re-querying relays
# Default: 300000 (5 minutes)
# Recommended: 300000-600000 (5-10 minutes) for production
VITE_NIP85_CACHE_TTL_MS=300000

# Phase 1: NIP-85 Default Exposure Level - Default privacy level for new users
# Options: public, contacts, whitelist, private
# - public: Share trust scores with everyone
# - contacts: Share only with known contacts
# - whitelist: Share only with explicitly whitelisted pubkeys
# - private: Never share trust scores (default, most private)
# Default: private (most restrictive)
VITE_NIP85_DEFAULT_EXPOSURE_LEVEL=private

# Phase 1: NIP-85 Primary Relay - Primary relay URL for publishing/querying assertions
# Used as default relay for all NIP-85 operations
# Default: wss://relay.satnam.pub
VITE_NIP85_PRIMARY_RELAY=wss://relay.satnam.pub

# ===========================================
# BLOSSOM IMAGE UPLOAD CONFIGURATION
# ===========================================
# Phase 4B: Blossom protocol for banner image uploads
# Phase 5A: Multi-server support with automatic failover

# Enable Blossom image uploads (Phase 4B)
# Default: false (opt-in)
VITE_BLOSSOM_UPLOAD_ENABLED=false

# Primary Blossom server URL (Phase 5A: self-hosted)
# Your self-hosted Blossom server for image uploads
# Example: https://blossom.satnam.pub
# Default: https://blossom.nostr.build (fallback to public server)
VITE_BLOSSOM_PRIMARY_URL=https://blossom.nostr.build

# Fallback Blossom server URL (Phase 5A: nostr.build)
# Used when primary server is unavailable or times out
# Default: https://blossom.nostr.build
VITE_BLOSSOM_FALLBACK_URL=https://blossom.nostr.build

# Request timeout before failover (Phase 5A)
# Time in milliseconds to wait before switching to fallback server
# Default: 30000 (30 seconds)
# Recommended: 15000-30000 (15-30 seconds)
VITE_BLOSSOM_TIMEOUT_MS=30000

# Number of retry attempts per server (Phase 5A)
# How many times to retry upload on each server before failing over
# Default: 2
# Recommended: 2-3 attempts
VITE_BLOSSOM_RETRY_ATTEMPTS=2

# Legacy configuration (Phase 4B compatibility)
# Deprecated: Use VITE_BLOSSOM_PRIMARY_URL instead
VITE_BLOSSOM_NOSTR_BUILD_URL=https://blossom.nostr.build

# ===========================================
# NIP-PNS + NOISE-FS CONFIGURATION
# ===========================================
# Noise Protocol forward secrecy for Private Notes to Self (NIP-PNS)
# Provides additional encryption layer beyond nsec for private notes

# Master feature flag for Noise-FS PNS integration
# DEPENDENCY: Requires VITE_NOISE_EXPERIMENTAL_ENABLED=true
# Default: false (opt-in)
VITE_PNS_NOISE_FS_ENABLED=false

# Default security mode for new private notes
# Options:
# - "none": Standard NIP-PNS encryption (nsec-derived keys only)
# - "noise-fs": Noise Protocol forward secrecy layer (inner encryption with ratcheting)
# Default: "none" (backward compatible)
VITE_PNS_DEFAULT_SECURITY_MODE=none

# Default security tier for Noise-FS protected notes
# Options:
# - "ephemeral-standard": Session-based keys, cleared on tab close (3-factor)
# - "everlasting-standard": Long-lived FS for archival notes (3-factor)
# - "hardened": Adds NFC hardware MFA verification (5-factor)
# Default: "everlasting-standard" (best balance of security and usability)
VITE_PNS_DEFAULT_SECURITY_TIER=everlasting-standard

# Storage mode for pns_fs_root secret (the master secret for Noise-FS)
# Options:
# - "local-only": Secret stored only in ClientSessionVault (maximum privacy, single device)
# - "relay-sync": Secret encrypted and stored on relays (cross-device sync capability)
# Default: "local-only" (privacy-first)
VITE_PNS_FS_SECRET_STORAGE_MODE=local-only

# Default TTL for ephemeral notes (in seconds)
# Ephemeral notes are automatically deleted after this duration
# Presets: 86400 (1 day), 604800 (7 days), 2592000 (30 days), 7776000 (90 days)
# Default: 604800 (7 days)
VITE_PNS_EPHEMERAL_DEFAULT_TTL=604800

# Auto-migrate existing standard PNS notes when Noise-FS is enabled
# When true, existing notes are re-encrypted with Noise-FS protection
# Default: false (manual migration for user control)
VITE_PNS_AUTO_MIGRATE_EXISTING_NOTES=false

# Require hardware MFA (NFC) for hardened tier notes
# When true, creating/accessing hardened tier notes requires NFC token verification
# Default: true (security best practice)
VITE_PNS_REQUIRE_HARDWARE_MFA=true
